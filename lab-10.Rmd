---
title: "Lab 10 - Grading the professor, Pt. 2"
author: "Fiona Wang"        
date: "March 24th, 2025"
output: github_document
---

## Load packages and data

```{r load-packages, message=FALSE}
library(tidyverse) 
library(tidymodels)
library(openintro)
```

## Exercise 1
Load data
```{r loaddata}
data <- evals
```

Simple linear regression m_bty:
```{r}
m_bty <- linear_reg() %>% 
  set_engine("lm") %>% 
  fit(score ~ bty_avg, data = data)
tidy(m_bty)
glance(m_bty)
```
The linear model is: score = 0.067(bty_avg) + 3.88.      
R^2 is 0.035 whereas the adjusted R^2 is 0.033. 

## Exercise 2
Multiple regression model
```{r beautygender}
m_bty_gen <- linear_reg() %>% 
  set_engine("lm") %>% 
  fit(score ~ bty_avg * gender, data = data)
tidy(m_bty_gen)
glance(m_bty_gen)
```

This multiple regression: score = 0.0306(bty_avg) - 0.1835(gender) + 0.080(bty_avg)(gender) + 3.95
The R^2 is 0.071 whereas the adjusted R^2 is 0.065. 

### Exercise 3 (fix from here)
Based on the result from the last exercise, there are three slopes.       
The first slope is 0.0306 for average beauty rating. This means that with one unit increase in the average beauty rating, there is a 0.0306 unit increase in the score while all else is held constant.       
The second slope is -0.1835 for gender. This means that with one unit increase in gender, there is a 0.1835 unit decrease in the score while all else is held constant. As we know from the last lab, female is the reference group, whereas male is 1 unit higher than female. So, male will be 0.1835 lower on average in score than females while all else is held constant.    
The slope for the interaction term is 0.080. This means that there is an interaction effect between average beauty rating and gender. With one unit increase in gender, the slope for average beauty rating will increase 0.08. So, for males, the slope for beauty average rating is 0.1106, while for females, the slope is still 0.0306. 
The intercept is 3.95. This means that when the average beauty rating is 0, and that the professor is a female, this professor will have a rating of 3.95.    

### Exercise 4
According to the R^2 values, 7.1% of the variance in score is explained by the model m_bty_gen, but this is a more optimistic interpretation. If we look at the adjusted R^2, this model explains 6.5% of the variance in score. 

### Exercise 5
For male professors, the line of best fit is:      
score = 0.0306(bty_avg) - 0.1835(gender) + 0.080(bty_avg)(gender) + 3.95     
Since males are gender = 1, we can further write the equation as:      
score = 0.1106(bty_avg) + 3.7665

### Exercise 6
Since I added the interaction term, there is no single answer for this question. For two professors who received 5 for their average beauty rating, males tended to have a higher course evaluation score. For two professors who received 1 for their average beauty rating, females tended to have a higher course evaluation score. 

### Exercise 7
According to our equation, we know that the relationship between beauty average rating and evaluation score is a positive relationship, slope = 0.0306, while all else held constant. However, as indicated by the interaction term, the relationship between beauty average rating and evaluation score increases 0.08. For males, this relationship is stronger than for females. 
